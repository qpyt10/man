#!/bin/bash
################ check hostname ##################
chk_host ()
#
# 18.09.07
# 08.04.08 modified
#
# check all hostname in local $LIST
# define:
# 1) global variable $myname
#    named as the my host name
# 2) global variable $myhost
#    with my host name
#
{
# LIST="myname/$HOST"
# list of possible hostname
# (in listhost.txt)
local LIST="
theory6/theory6.chem.uniroma1.it
theory16/theory16.chem.uniroma1.it
drone/drone.caspur.it
jamaica/jamaica.caspur.it
poseidon/poseidon
theory20/theory20.chem.uniroma1.it
cineca/node248
cineca/node1309
theory23/theory23.chem.uniroma1.it
man/pwr503.caspur.it
caspur/hpc2.caspur.it
"
#     NUML=number of host
local NUML=$(echo $LIST|wc -w)
local flag
local i
declare -i i flag
for i in `seq $NUML`
do
#       name=line of LIST
local   name=$(echo $LIST|awk "{print $ $i}")
#     myname=name before / (my host name)
local myname=${name%*/*}
#     itname=name after /  ($HOST)
local itname=${name#*/*}
if [ $HOSTNAME == $itname ];then
export $myname=$myname
# define a global variable named as my host name
export myhost=$myname
# $myhost contains my host name (global variable)
return 0
else
flag=1
fi
done
if (( $flag == 1 ));then
echo invalid hostname
return $flag
fi
}
chk_host
############## end check hostname ################
